\section{Finite element approximation}
In this section we consider the discretization of Problem 1 and 2 by means of the finite element method. We address two main challenges; first we aim to identify a suitable approximation space for the Lagrange multiplier and to analyze the stability of the discrete saddle point problem; second we aim to derive a stable discretization method that uses indepent and conforming computational meshes for $\Omega$, $\Gamma$ and $\Lambda$. Let us introduce a shape-regular triangulation $\mathcal{T}^{\Omega}_h$ of $\Omega$ and an admissible partition $\mathcal{T}^{\Lambda}_{h}$ of $\Lambda$.
We analyze two different cases: the one in which the 3D mesh is conforming to the interface $\Gamma$, namely the set of the intersections of the 3D elements of $\mathcal{T}^{\Omega}_h$ with $\Gamma$ is constituted by facets of such elements, and the non conforming case, namely the interface $\Gamma$ cuts the mesh arbitrarly. The discrete equivalent of \eqref{eq:saddle-point} reads as finding $u_h\in X_h\subset X$, $\lambda_h\in Q_h\subset Q$ s.t.
\begin{eqnarray}\label{eq:saddle-point_discrete}
\begin{cases}
a(u_h,v_h)+b(v_h,\lambda_h)=c(v_h)\quad &\forall v_h\in X_h\\
b(u_h,\mu_h)=d(\mu_h) \quad &\forall \mu_h\in Q_h.
\end{cases}
\end{eqnarray}
Let $B_h: Q'_h \longrightarrow Q_h$ be the operator induced by $b$ such that $\langle B_h v_h,\mu _h\rangle_{Q'_h,Q_h} = b(v_h,\mu _h)$.
The well posedness of such problem is governed by the classical inf-sup theory in Banach spaces. The main result is reported below.

\begin{corollary}{\cite[Theorem 2.42]{MR2050138}}Let $a(\cdot, \cdot)$ and $b(\cdot, \cdot)$ be continuous bilinear forms. 
Problem \eqref{eq:saddle-point_discrete} is well-posed if and only if 
\begin{equation}\label{BNB1_discrete}
\exists \alpha_h >0 :\, \inf_{u_h\in ker(B_h)}\sup_{v_h\in ker(B_h)} \frac{a(u_h,v_h)}{\|u_h\|_{X}\|v_h\|_{X}}\geq \alpha_h
\end{equation}
and 
\begin{equation}\label{eq:infsup_discrete}
\exists \beta_h >0:\,\inf_{\mu_h\in Q_h}\sup_{v_h\in X_h} \frac{b(v_h,\mu_h)}{\|v_h\|_{X}\|\mu_h\|_{Q}}\geq \beta_h .
\end{equation}
\end{corollary}
This corollary is the discrete counterpart of Theorem \ref{th:bnb} where at the discrete level condition \eqref{BNB1_discrete} implies both of \eqref{BNB1}. Conversely, \eqref{eq:infsup_discrete} does not follow from the conformity of the finte element spaces and it must be analysed independetly of \eqref{eq:infsup}.  
Let us notice that for both problem 1 and problem 2 the bilinear form $a(\cdot, \cdot)$ is coercive as stated in Lemmas \eqref{lemma:prob1_coercivity} and \eqref{lemma:prob2_coercivity}. Consequently, \eqref{BNB1_discrete} is automatically satisfied, being $\alpha_h$ the coercivity constant.\\

\subsection{$\mathcal{T}^{\Omega}_h$ conforming to $\Gamma$}
 We first analyze the case in which the 3D mesh is conforming to the interface $\Gamma$. With this aim, we define conformity conditions between $\mathcal{T}^{\Omega}_h$ and $\mathcal{T}^{\Lambda}_h$ with $\Gamma$. More precisely we require that the intersection of $\mathcal{T}^{\Omega}_h$ and $\Gamma$ is made of entire faces of elemets $K \in \mathcal{T}^{\Omega}_h$. Furthermore, we also set a restriction between $\mathcal{T}^{\Omega}_h$ and $\mathcal{T}^{\Lambda}_h$. We assume that $\Lambda$ is a piecewise linear manifold. We want that the intersection of $\Gamma$ with any orthogonal plane to $\Lambda$ that crosses $\Lambda$ at the internal nodes of $\mathcal{T}^{\Lambda}_h$, consists of entire edges of $\mathcal{T}^{\Omega}_h$. Namely the intersection of $\Gamma$ with orthogonal planes to $\Lambda$ is conformal with $\mathcal{T}^{\Lambda}_h$.
\subsubsection{Problem 1}
We denote by $X_{h,0}^k(\Omega)\subset H^1_0(\Omega)$, with $k>0$, the conforming finite element space of continuous piecewise polynomials of degree $k$ defined on $\Omega$ satisfying homogeneous Dirichlet conditions on the boundary and by $X_{h,0}^k(\Lambda)\subset H^1_0(\Lambda)$ the space of continuous piecewise polynomials of degree $k$ defined on $\Lambda$, satisfying homogeneous Dirichlet conditions on $\Lambda \cap \partial \Omega$. 
%Moreover, $Q_{h}$ denotes a suitable trial space for the lagrange multiplier $\lambda_h$. In particular, $Q_h \subset H^{-\frac12}(\Gamma )$ in the case of Problem 1 and $Q_h \subset H^{-\frac12}(\Lambda)$ in the case of Problem 2.
Problem 1 consists to find $u_h \in X_{h,0}^k (\Omega) ,\, {\ud}_h \in X_{h,0}^k(\Lambda) ,\, \lambda_h \in Q_h \subset H^{-\frac12}(\Gamma )$, such that
\begin{subequations}
\begin{align}
&(u_h,v_h)_{H^1(\Omega)} + ({\ud}_h,{\vd}_h)_{H^1(\Lambda),|\D|} 
+ \langle \trace v_h  - \mathcal{E}_{\Lambda} {\vd}_h, \lambda_h \rangle_\Gamma 
\\
\nonumber
&\qquad\qquad= (f,v_h)_{L^2(\Omega)} + (\avrd{g},{\vd}_h)_{L^2(\Lambda),|\D|}
\quad \forall v_h \in X_{h,0}^k(\Omega), \ {\vd}_h \in X_{h,0}^k(\Lambda)
\\
&   \langle \trace u_h - \mathcal{E}_{\Lambda} {\ud}_h , \mu_h \rangle_\Gamma = 0
\quad \forall \mu_h \in Q_h\,,
\end{align}
\end{subequations}
The space $Q_h$ must be suitably chosen such that \eqref{eq:infsup_discrete} holds. Let $Q_h$ be the trace space of functions running in $X_{h,0}^k(\Omega)$, namely the space of continuous piecewise polynomials of degree $k$ defined on $\Gamma$ which satisfy homogeneous Dirichlet conditions on $\partial \Omega$.As a result, $Q_h=X_{h,0}^k(\Gamma)$. Therefore we impose homogeneous Dirichlet boundary condition on $\partial \Omega$ also for the Lagrange multiplier. For this choice of $Q_h$ we can prove the well-posedness of the discrete problem, as shown in the following. 

\begin{lemma}
Let $P_h: H^{\frac 12}_{00}(\Gamma) \longrightarrow Q_h$ be the orthogonal projection operator defined  for any $v \in H^{\frac 12}_{00}(\Gamma)$ by
\begin{equation*}
(P_h v , \psi_h)_\Gamma= (v, \psi_h)_\Gamma \qquad \forall \psi_h \in Q_h.  
\end{equation*} 
Then, $P_h$ is continuous on $H^{\frac 12}_{00}(\Gamma)$, namely
\begin{equation}\label{continuity_projoper}
\|P_h v\|_{H^{\frac 12}(\Gamma)} \leq C \|v\|_{H^{\frac 12}(\Gamma)},
\end{equation}
where $C$ is a positive constant independent of $h$.
\end{lemma}
\begin{proof}
We prove that $P_h$ is continuous on $L^2(\Gamma)$ and on $H^1_0(\Gamma)$ following \cite[Section 1.6.3]{MR2050138}.  Then, the inequality \eqref{continuity_projoper} can be dirived by Hilbertian interpolation. For the $L^2$-continuity, we exploit the fact that, from the definition of $P_h$,
\begin{equation*}
(v-P_h v,P_h v)_{\Gamma}=0.
\end{equation*} 
Therefore, by Pythagoras identity,
\begin{equation*}
\|v\|^2_{L^2(\Gamma)} = \|v-P_h v\|_{L^2(\Gamma)}^2 + \|P_h v\|_{L^2(\Gamma)}^2 \geq \|P_h v\|^2 _{L^2(\Gamma)}.
\end{equation*}
Let us now consider $v\in H^1_0(\Gamma)$.The Scott-Zhang interpolation operator $SZ_h$ from $H^1_0(\Gamma)$ to $Q_h$ satisfies the following inequalities,
\begin{equation}\label{SZ_stability}
\|SZ_h v\|_{H^1(\Gamma)} \leq C_1 \|v\|_{H^1(\Gamma)}
\end{equation} 
\begin{equation}\label{SZ_approx}
\|v -SZ_h v \|_{L^2(\Gamma)}\leq C_2 h \|v\|_{H^1(\Gamma)}.
\end{equation}
Therefore, using \eqref{SZ_stability},
\begin{equation*}
\begin{split}
\|\nabla P_h v\|_{L^2(\Gamma)} 
&\leq \|\nabla (P_h v - SZ_h v)\|_{L^2(\Gamma)} + \|\nabla SZ_h v\|_{L^2(\Gamma)}\\
&\leq  \|\nabla (P_h v - SZ_h v)\|_{L^2(\Gamma)} + C_1\|v\|_{H^1(\Gamma)}
\end{split}
\end{equation*}
and by using the inverse inequality we obtain
\begin{equation*}
\begin{split}
\|\nabla (P_h v - SZ_h v)\|_{L^2(\Gamma)} + C_1\|v\|_{H^1(\Gamma)}
&\leq \frac{C_3}{h} \|P_h v - SZ_h v\|_{L^2(\Gamma)} + C_1\|v\|_{H^1(\Gamma)}\\
&= \frac{C_3}{h} \|P_h (v - SZ_h v)\|_{L^2(\Gamma)} + C_1\|v\|_{H^1(\Gamma)}\\
&\leq  \text{ (Stability of $P_h$ in $L^2$) } \frac{C_3}{h} \|v - SZ_h v\|_{L^2(\Gamma)} + C_1\|v\|_{H^1(\Gamma)}\\
&\leq \text{ (using \eqref{SZ_approx}) } \frac{C_3}{h} C_2 h  \| v\|_{H^1(\Gamma)} + C_1\|v\|_{H^1(\Gamma)}\\
&\leq (C_2 C_3 +C_1) \|v\|_{H^1(\Gamma)},
\end{split}
\end{equation*}
from which we obtain the continuity in $H^1_0(\Gamma)$.\\
\end{proof}
\begin{lemma}\label{lemma:trspace_infsup} 
There exists a constant $\gamma >0$ such that for any $\mu_h\in Q_h$
\begin{equation*}
\sup_{\substack{q_h \in Q_h}} \frac{\langle q_h , \mu_h \rangle}{ \|q_h\|_{H^{\frac 12}(\Gamma)}} \geq \gamma \|\mu_h\|_{H^{-\frac 12}(\Gamma)}.
\end{equation*} 
\end{lemma}
\begin{proof}
Let $\mu_h$ be in $Q_h$. From the continuous case, in particular from \eqref{infsup_traceop}, we have
\begin{equation*}
\|\mathcal{E}_\Omega\|^{-1} \|\mu_h\|_{H^{-\frac 12}(\Gamma)} \leq \sup_{\substack{v \in H^1_0(\Omega)}} \frac{\langle \trace v , \mu_h \rangle}{\|v\|_{H^1(\Omega)}} 
\end{equation*}
and by the trace inequality $\|\trace v\|_{H^\frac 12 (\Gamma)} \leq C_T \|v\|_{H^1(\Omega)}$ (see \cite[7.56]{adams1975pure}), we obtain 
\begin{equation*}
\sup_{\substack{v \in H^1_0(\Omega)}} \frac{\langle \trace v , \mu_h \rangle}{\|v\|_{H^1(\Omega)}}
\leq C_T \sup_{\substack{v \in H^1_0(\Omega)}} \frac{\langle \trace v , \mu_h \rangle}{ \|\trace v\|_{H^{\frac 12}(\Gamma)}}.
\end{equation*}
By the definition of $P_h$ and \eqref{continuity_projoper} 
\begin{equation*}
\begin{split}
C_T \sup_{\substack{v \in H^1_0(\Omega)}} \frac{\langle \trace v , \mu_h \rangle}{ \|\trace v\|_{H^{\frac 12}(\Gamma)}}&= C_T \sup_{\substack{v \in H^1_0(\Omega)}} \frac{\langle P_h(\trace v) , \mu_h \rangle}{ \|\trace v\|_{H^{\frac 12}(\Gamma)}}\\
&\leq  C_T C \sup_{\substack{v \in H^1_0(\Omega)}} \frac{\langle P_h(\trace v) , \mu_h \rangle}{ \|P_h(\trace v)\|_{H^{\frac 12}(\Gamma)}}\\
&= C_T C \sup_{\substack{q_h \in Q_h}} \frac{\langle q_h , \mu_h \rangle}{  \|q_h\|_{H^{\frac 12}(\Gamma)}}.
\end{split}
\end{equation*}
\end{proof}

\begin{theorem}[Discrete inf-sup] The inequality \eqref{eq:infsup_discrete} holds, namely 
$\exists \beta_{h,1} >0$ s.t.
\begin{equation}\label{inf_sup_discrete_prob1}
\inf_{\mu_h \in Q_h} 
\sup_{\substack{v_h \in X_{h,0}^k(\Omega),\\ {\vd}_h \in X_{h,0}^k(\Lambda)}} \frac{ \langle \trace v_h - \ext {\vd}_h, \mu_h \rangle _{\Gamma}} {\vertiii{[v_h, {\vd} _h]} \|\mu_h\|_{H^{-\frac 12 }(\Gamma)}} 
\geq \beta_{h,1}. 
\end{equation}
\end{theorem}

\begin{proof}
Let $\mu_h \in Q_h$. As in the continuos case, we choose ${\vd}_h =0$ and we have
\begin{equation*}
\sup_{\substack{v_h \in X_{h,0}^k(\Omega),\\ {\vd}_h \in X_{h,0}^k(\Lambda)}} \frac{ \langle \trace v_h - \ext {\vd}_h, \mu_h \rangle _{\Gamma}} {\vertiii{[v_h,  {\vd}_h]}}
\geq \sup_{v_h \in X_{h,0}^k(\Omega)} \frac{ \langle \trace v_h, \mu_h \rangle _{\Gamma} } {\|v_h\|_{H^1(\Omega)}}.
\end{equation*}

Therefore, we want to prove that there exists $\beta_{h,1}$ such that
\begin{equation*}
\sup_{v_h \in X_{h,0}^k(\Omega)} \frac{ \langle \trace v_h, \mu_h \rangle _{\Gamma} } {\|v_h\|_{H^1(\Omega)}} \geq \beta_{h,1} \|\mu_h\|_{H^{-\frac 12}(\Gamma)} \qquad \forall \mu_h \in Q_h.
\end{equation*}

Using Lemma \ref{lemma:trspace_infsup} and the boundedness of the armonic extension operator $\mathcal{E}_{\Omega}$ from $H^{\frac 12}_{00}(\Gamma)$ to $H^1_0(\Omega)$ introduced in the previous section, we have
\begin{equation*}
\gamma \|\mu_h\|_{H^{-\frac 12}(\Gamma)} \leq  \sup_{q_h \in Q_h} \frac{ \langle q_h, \mu_h \rangle _{\Gamma} } {\|q_h\|_{H^{\frac 12}(\Gamma)}} 
\leq 
\|\mathcal{E}_{\Omega}\| \sup_{q_h \in Q_h} \frac{ \langle q_h, \mu_h \rangle _{\Gamma} } {\|\mathcal{E}_\Omega q_h\|_{H^1(\Omega)}} .
\end{equation*}
Let $R_h: H^1_0(\Omega) \rightarrow X_{h,0}^k(\Omega)$ be a quasi interpolation operator (such as the Scott-Zhang operator) satisfying 
\begin{equation*}
\|R_h v\|_{H^1(\Omega)} \leq C_R \|v\|_{H^1(\Omega)} \qquad \forall v \in H^1_0(\Omega).
\end{equation*}
Therefore, we obtain 
\begin{equation*}
\|\mathcal{E}_{\Omega}\| \sup_{q_h \in Q_h} \frac{ \langle q_h, \mu_h \rangle _{\Gamma} } {\|\mathcal{E}_{\Omega}q_h\|_{H^1(\Omega)}} 
\leq
\|\mathcal{E}_{\Omega}\| C_R \sup_{q_h \in Q_h} \frac{ \langle q_h, \mu_h \rangle _{\Gamma} } {\|R_h \mathcal{E}_{\Omega} q_h\|_{H^1(\Omega)}}
\end{equation*}
and we have
\begin{multline}\label{eq_conformity}
\gamma \|\mu_h\|_{H^{-\frac 12}(\Gamma)} 
\leq 
\sup_{q_h \in Q_h} \frac{ \langle q_h, \mu_h \rangle_{\Gamma} } {\|q_h\|_{H^{\frac 12}(\Gamma)}} 
\leq
\|\mathcal{E}_{\Omega}\| C_R \sup_{q_h \in Q_h} \frac{ \langle q_h, \mu_h \rangle_{\Gamma} } {\|R_h \mathcal{E}_{\Omega} q_h\|_{H^1(\Gamma)}}
\\
=
\|\mathcal{E}_{\Omega}\| C_R \sup_{q_h \in Q_h} \frac{ \langle \trace R_h  \mathcal{E}_{\Omega}q_h, \mu_h \rangle_{\Gamma} } {\|R_h \mathcal{E}_{\Omega} q_h\|_{H^1(\Omega)}} 
\leq \|\mathcal{E}_{\Omega}\| C_R \sup_{v_h \in X_{h,k}(\Omega)} \frac{ \langle \trace v_h, \mu_h \rangle_{\Gamma} } {\|v_h\|_{H^1(\Omega)}}. 
\end{multline}
Therefore the inf-sup condition $\eqref{inf_sup_discrete_prob1}$ holds with $\beta_{h,1} = \gamma \|\mathcal{E}_{\Omega}\|^{-1} C_R^{-1} $. We notice that in \eqref{eq_conformity} we exploit the fact that the operator $\trace R_h  \mathcal{E}_{\Omega}$ coincides with the identity on the space $Q_h$, thanks to the conformity of $\mathcal{T}^{\Omega}_h$ to the interface $\Gamma$.
\end{proof}

%\begin{remark} We notice that to prove the result in Lemma \ref{lemma:trspace_infsup} (and then the discrete inf-sup condition)  basically we need a projection operator $P_h: H^{\frac 12}_{00} \longrightarrow W_{h,0}^k(\Gamma)$ orthogonal in the multiplier space $Q_h$, namely such that $\langle P_h v, \mu_h \rangle = \langle v, \mu_h \rangle, \, \forall \mu_h \in Q_h$, and continuous in $H^{\frac 12}(\Gamma)$. Therefore, in principle different choices than $Q_h=W_{h,0}^k(\Gamma)$ could be considered if we can build an operator $P_h$ satisfying these properties. In \cite{belgacem1999mortar} such operator $P_h$  is built for a particular choice of $Q_h$ but it is not clear how to prove the $H^1$-stability inequality (and consequently the $H^{\frac 12 }$-stability) with a constant independent of the mesh size $h$.
%\end{remark}  

\subsubsection{Problem 2}
This problem requires to find  $u_h \in X_{h,0}^k(\Omega) ,\ {\ud}_h \in X_{h,0}^k(\Lambda), \ {\ld}_h \in Q_h \subset H^{-\frac12}(\Lambda)$, such that
\begin{subequations}
\begin{align}\label{eq:prob2_discrete}
&(u_h,v_h)_{H^1(\Omega)} + ({\ud}_h,{\vd}_h)_{H^1(\Lambda), |{\cal D}|} 
+  \langle  \mtrace v_h -  {\vd}_h, {\ld}_h \rangle_{\Lambda, |\DD|} 
\\
\nonumber
&\qquad\qquad= (f,v_h)_{L^2(\Omega)} + (\avrd{g},{\vd}_h)_{L^2(\Lambda), |{\cal D}|}
\quad \forall v_h \in X_h(\Omega), \ {\vd}_h \in X_h(\Lambda)
\\
&  \langle \mtrace u_h - {\ud}_h, {\md}_h \rangle_{\Lambda,| \DD| } = 0
\quad \forall {\md}_h \in Q_h\,.
\end{align}
\end{subequations}

%We introduce the space
%$W_{h,0}^k(\Lambda) \subset H^{\frac 12} _{00} (\Lambda)$, which is the averaged trace space of functions running in $X_{h,0}^k(\Omega)$. It coincides with the space of continuous piecewise polynomials of degree $k$ defined on $\Lambda$ and satisfying homogeneous Dirichlet boundary condition, namely $X_{h,0}^k(\Lambda)$. 
We choose $Q_h=X_{h,0}^k(\Lambda)$, therefore we impose homogeneous Dirichlet boundary condition on $\Lambda \cap \partial \Omega$ also for the Lagrange multiplier. With this choice for $Q_h$, we can prove the well-posedness of the discrete problem. In particular, following the same steps as for Problem 1, we can prove the following results.

%**** uniform \DD
%\begin{lemma}
%Let $P_h: H^{\frac 12}_{00}(\Lambda) \longrightarrow Q_h$ be the orthogonal projection operator defined  for any $v \in H^{\frac 12}_{00}(\Lambda)$ by
%\begin{equation*}
%(P_h v , \psi)_\Lambda= (v, \psi)_\Lambda \qquad \forall \psi \in Q_h.  
%\end{equation*} 
%Then, $P_h$ is continuous on $H^{\frac 12}_{00}(\Lambda)$, namely
%\begin{equation*}
%\|P_h v\|_{H^{\frac 12}_{00}(\Lambda)} \leq C \|v\|_{H^{\frac 12}_{00}(\Lambda)},
%\end{equation*}
%where $C$ is a positive constant independent of $h$.
%\end{lemma}
%
%\begin{lemma}\label{infsup_avr_trspace}
%There exist a constant $\gamma >0$ such that
%\begin{equation*}
%\sup_{\substack{q_h \in W_{h,0}^k(\Lambda)}} \frac{\langle q_h , \mu_h \rangle}{ \|q_h\|_{H^{\frac 12}(\Lambda)}} \geq \gamma \|\mu_h\|_{H^{-\frac 12}(\Lambda)} \qquad \forall \mu_h \in Q_h.
%\end{equation*} 
%\end{lemma}
%
%\begin{theorem}[Discrete inf-sup] The inequality \eqref{eq:infsup_discrete} holds, namely 
%$\exists \beta_{h,2} >0$ s.t.
%\begin{equation}
%\inf_{\mu_h \in Q_h} 
%\sup_{\substack{v_h \in X_{h,0}^k(\Omega),\\ {\vd}_h \in X_{h,0}^k(\Lambda)} }\frac{\langle \mtrace v_h -  {\vd}_h, {\md}_h \rangle _{\Lambda,|\DD|} } {\vertiii{[v_h, {\vd}_h]} \|{\md}_h\|_{H^{-\frac 12 }(\Lambda)} } 
%\geq \beta_{h,2}. 
%\end{equation}
%\end{theorem}
%\begin{proof}
%Let ${\md}_h$ be arbitrarly chosen in $Q_h$. Again, we choose ${\vd}_h =0$, so that the proof reduces to show that there exists $\beta_{h,2}$ such that
%\begin{equation*}
%\sup_{v_h \in X_{h,0}^k(\Omega)} \frac{ \langle \mtrace v_h , {\md}_h \rangle _{\Lambda,|\DD|} } {\|v_h\|_{H^1(\Omega)} }\geq \beta_{h,2} \|{\md}_h\|_{H^{-\frac 12}(\Lambda)}\ \qquad \forall {\md}_h \in Q_h.
%\end{equation*}
%Let us denote with $\ext$ the uniform extension operator from $\Lambda$ to $\Gamma$. Using Lemma \ref{H12norm_Gamma}, we easily have for any $w \in H^{\frac 12}(\Lambda)$,\\
%{\color{red} TO DO: generalize to non constant $\DD$}
%\begin{equation*}
%\|\mathcal{U}_E w\|_{H^{\frac 12}(\Gamma)}=|\DD| \|w\|_{H^{\frac 12}(\Lambda)}.
%\end{equation*}
%Consequently, from Lemma \ref{infsup_avr_trspace}, using again the extension operator $E$ from $H^{\frac 12}(\Gamma)$ to $H^1_0(\Omega)$ and the quasi interpolation operator $R_h$ from $H^1_0(\Omega)$ to $X_{h,0}^k(\Omega)$, we obtain
%\begin{multline}
%\gamma \|\mu_h\|_{H^{-\frac 12}(\Lambda)} \leq 
%\sup_{q_h \in W_{h,0}^k(\Lambda)} \frac{ \langle q_h, \mu_h \rangle_{\Lambda} } {\|q_h\|_{H^{\frac 12}(\Lambda)}} 
%\\
%= |\DD| \sup_{q_h \in W_{h,0}^k(\Lambda)} \frac{ \langle q_h, \mu_h \rangle _{\Lambda}} {\|\mathcal{U}_E q_h\|_{H^{\frac 12}(\Gamma)}} 
%\leq |\DD|\|E\| \sup_{q_h \in W_{h,0}^k(\Lambda)} \frac{ \langle q_h, \mu_h \rangle _{\Lambda} } {\|E \mathcal{U}_E q_h\|_{H^1(\Omega)}} 
%\\
%\leq |\DD|\|E\| C_R \sup_{q_h \in W_{h,0}^k(\Lambda)} \frac{ \langle q_h, \mu_h \rangle _{\Lambda} } {\|R_h E \mathcal{U}_E q_h\|_{H^1(\Omega)}}
%\\ 
%=  |\DD|\|E\| C_R \sup_{q_h \in W_{h,0}^k(\Lambda)} \frac{ \langle \Pi _1  R_h E \mathcal{U}_E q_h, \mu_h \rangle _{\Lambda}} {\|R_h E \mathcal{U}_E w_h\|_{H^1(\Omega)}}
%\\
%\leq |\DD|\|E\| C_R \sup_{v_h \in X_h(\Omega)} \frac{ \langle \Pi _2  v_h, \mu_h \rangle _{\Lambda}} {\|v_h\|_{H^1(\Omega)}}. 
%\end{multline}
%
%%\begin{equation*}
%%\|\mathcal{U}_E w\|_{H^{\frac 12}(\Gamma)}\lesssim \|w\|_{H^{\frac 12}(\Lambda)}.
%%\end{equation*}
%%Consequently, from Lemma \ref{infsup_avr_trspace}, using again the extension operator $\mathcal{E}$ from $H^{\frac 12}(\Gamma)$ to $H^1_0(\Omega)$ and the quasi interpolation operator $R_h$ from $H^1_0(\Omega)$ to $X_{h,0}^k(\Omega)$, we obtain
%%\begin{multline}
%%\gamma \|{\md}_h\|_{H^{-\frac 12}(\Lambda)} \leq 
%%\sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle_{\Lambda} } {\|q_h\|_{H^{\frac 12}(\Lambda)}} 
%%\\
%%\lesssim \sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle _{\Lambda}} {\|\mathcal{U}_E q_h\|_{H^{\frac 12}(\Gamma)}} 
%%\lesssim \|\mathcal{E}\| \sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle _{\Lambda} } {\|\mathcal{E} \mathcal{U}_E q_h\|_{H^1(\Omega)}} 
%%\\
%%\lesssim \|\mathcal{E}\| C_R \sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle _{\Lambda} } {\|R_h E \mathcal{U}_E q_h\|_{H^1(\Omega)}}
%%\\ 
%%\lesssim\|\mathcal{E}\| C_R \sup_{q_h \in Q_h} \frac{ \langle \avrc{TR_h E \mathcal{U}_E q_h}, {\md}_h \rangle _{\Lambda}} {\|R_h E \mathcal{U}_E q_h\|_{H^1(\Omega)}}
%%\\
%%\lesssim\|\mathcal{E}\| C_R \sup_{v_h \in X_h(\Omega)} \frac{ \langle \avrc{T v_h}, {\md}_h \rangle _{\Lambda}} {\|v_h\|_{H^1(\Omega)}}. 
%%\end{multline}
%
%\end{proof}
%


%*******************extension to non uniform $|\DD|$

\begin{lemma}\label{lemma:prob1_orthproj}
Let $P_h: H^{\frac 12}_{00}(\Lambda) \longrightarrow Q_h$ be the orthogonal projection operator defined  for any $v \in H^{\frac 12}_{00}(\Lambda)$ by
\begin{equation*}
(P_h v , \psi)_{\Lambda,|\DD|}= (v, \psi)_{\Lambda , |\DD|} \qquad \forall \psi \in Q_h.  
\end{equation*} 
Then, $P_h$ is continuous on $H^{\frac 12}_{00}(\Lambda)$, namely
\begin{equation*}
\|P_h v\|_{H^{\frac 12}(\Lambda),|\DD|} \leq C \|v\|_{H^{\frac 12}(\Lambda),|\DD|},
\end{equation*}
where $C$ is a positive constant independent of $h$.
\end{lemma}

\begin{lemma}\label{infsup_avr_trspace}
There exist a constant $\gamma >0$ such that
\begin{equation*}
\sup_{\substack{q_h \in Q_h}} \frac{\langle q_h , {\md}_h \rangle_{\Lambda, |\DD|}}{ \|q_h\|_{H^{\frac 12}(\Lambda),|\DD|}} \geq \gamma \|{\md}_h\|_{H^{-\frac 12}(\Lambda)} \qquad \forall {\md}_h \in Q_h.
\end{equation*} 
\end{lemma}
The proofs are equivalent ot the ones of Lemmas \ref{lemma:prob1_orthproj} and \ref{lemma:trspace_infsup}.
\begin{theorem}[Discrete inf-sup] The inequality \eqref{eq:infsup_discrete} holds, namely 
$\exists \beta_{h,2} >0$ s.t.
\begin{equation}
\inf_{\mu_h \in Q_h} 
\sup_{\substack{v_h \in X_{h,0}^k(\Omega),\\ {\vd}_h \in X_{h,0}^k(\Lambda)} }\frac{\langle \mtrace v_h -  {\vd}_h, {\md}_h \rangle _{\Lambda,|\DD|} } {\vertiii{[v_h, {\vd}_h]} \|{\md}_h\|_{H^{-\frac 12 }(\Lambda)} } 
\geq \beta_{h,2}. 
\end{equation}
\end{theorem}
\begin{proof}
Let ${\md}_h$ be arbitrarly chosen in $Q_h$. Again, we choose ${\vd}_h =0$, so that the proof reduces to show that there exists $\beta_{h,2}$ such that
\begin{equation*}
\sup_{v_h \in X_{h,0}^k(\Omega)} \frac{ \langle \mtrace v_h , {\md}_h \rangle _{\Lambda,|\DD|} } {\|v_h\|_{H^1(\Omega)} }\geq \beta_{h,2} \|{\md}_h\|_{H^{-\frac 12}(\Lambda)}\ \qquad \forall {\md}_h \in Q_h.
\end{equation*}
From Lemma \ref{lemma:H12norm} and its corollaries, for any $w \in H^{\frac 12}(\Lambda)$,
\begin{equation*}
\|\ext w\|_{H^{\frac 12}(\Gamma)}= \|w\|_{H^{\frac 12}(\Lambda),|\DD|}.
\end{equation*}

Consequently, from Lemma \ref{infsup_avr_trspace}, using again the extension operator $\mathcal{E}_{\Omega}$ from $H^{\frac 12}(\Gamma)$ to $H^1_0(\Omega)$ and the quasi interpolation operator $R_h$ from $H^1_0(\Omega)$ to $X_{h,0}^k(\Omega)$, we obtain
\begin{multline}
\gamma \|{\md}_h\|_{H^{-\frac 12}(\Lambda)} \leq 
\sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle_{\Lambda,|\DD|} } {\|q_h\|_{H^{\frac 12}(\Lambda),|\DD|}} 
\\
=  \sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle _{\Lambda,|\DD|}} {\|\ext q_h\|_{H^{\frac 12}(\Gamma)}} 
\leq \|\mathcal{E}_{\Omega}\| \sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle _{\Lambda,|\DD|} } {\|\mathcal{E}_{\Omega} \ext q_h\|_{H^1(\Omega)}} 
\\
\leq \|\mathcal{E}_{\Omega}\| C_R \sup_{q_h \in Q_h} \frac{ \langle q_h, {\md}_h \rangle _{\Lambda,|\DD|} } {\|R_h \mathcal{E}_{\Omega} \ext q_h\|_{H^1(\Omega)}}
\\ 
=  \|\mathcal{E}_{\Omega}\| C_R \sup_{q_h \in Q_h} \frac{ \langle 	\mtrace R_h \mathcal{E}_{\Omega} \ext q_h, {\md}_h \rangle _{\Lambda,|\DD|}} {\|R_h \mathcal{E}_{\Omega} \ext w_h\|_{H^1(\Omega)}}
\\
\leq \|\mathcal{E}_{\Omega}\| C_R \sup_{v_h \in X_h(\Omega)} \frac{ \langle \mtrace v_h, {\md}_h \rangle _{\Lambda,|\DD|}} {\|v_h\|_{H^1(\Omega)}}. 
\end{multline}
Also in this case to prove the disrete inf-sup condition we exploit the conformity of the meshes on $\Omega$, $\Gamma$ and $\Lambda$ and the fact that the operator $\mtrace R_h \mathcal{E}_{\Omega} \ext$ coincides with the identity if applied to functions in $Q_h$. 
\end{proof}